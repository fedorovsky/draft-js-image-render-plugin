(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{355:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.removeBlock=exports.addImage=void 0;var React=__importStar(__webpack_require__(1)),addImage_1=__importDefault(__webpack_require__(823));exports.addImage=addImage_1.default;var removeBlock_1=__importDefault(__webpack_require__(824));exports.removeBlock=removeBlock_1.default;var draft_js_1=__webpack_require__(14),ImageComponent=function(_a){var block=_a.block,src=_a.contentState.getEntity(block.getEntityAt(0)).getData().src;return React.createElement("img",{src:src,alt:"preview"})};exports.default=function(config){var _state={getEditorState:function(){return draft_js_1.EditorState.createEmpty()},setEditorState:function(){return null}},Image=(null==config?void 0:config.imageComponent)||ImageComponent;(null==config?void 0:config.decorator)&&(Image=null==config?void 0:config.decorator(Image));var DecoratedImage=function(props){return React.createElement(Image,__assign({},props,{getEditorState:_state.getEditorState,setEditorState:_state.setEditorState}))};return{initialize:function(_a){var getEditorState=_a.getEditorState,setEditorState=_a.setEditorState;_state={getEditorState:getEditorState,setEditorState:setEditorState}},blockRendererFn:function(block,_a){var getEditorState=_a.getEditorState;if("atomic"===block.getType()){var contentState=getEditorState().getCurrentContent(),entity=block.getEntityAt(0);if(!entity)return null;var type=contentState.getEntity(entity).getType();return"IMAGE"===type||"image"===type?{component:DecoratedImage,editable:!1}:null}return null}}}},360:function(module,exports,__webpack_require__){__webpack_require__(361),__webpack_require__(511),module.exports=__webpack_require__(512)},427:function(module,exports){},512:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(45),__webpack_require__(37),__webpack_require__(30),__webpack_require__(46),__webpack_require__(47);var _storybook_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(207),req=__webpack_require__(701);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_5__.configure)((function loadStories(){req.keys().forEach((function(filename){return req(filename)}))}),module)}.call(this,__webpack_require__(513)(module))},701:function(module,exports,__webpack_require__){var map={"./components/Editor/Editor.stories.tsx":702};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=701},702:function(module,exports,__webpack_require__){"use strict";(function(module){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var withSourceLoader=__webpack_require__(314).withSource,__STORY__=(__webpack_require__(314).addSource,"import * as React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport Editor from './Editor';\n\nstoriesOf('Components', module).add('Editor', () => <Editor />);\n"),__ADDS_MAP__={"components--editor":{startLoc:{col:36,line:5},endLoc:{col:62,line:5},startBody:{col:46,line:5},endBody:{col:62,line:5}}},React=__importStar(__webpack_require__(1)),react_1=__webpack_require__(207),Editor_1=__importDefault(__webpack_require__(705));react_1.storiesOf("Components",module).addParameters({storySource:{source:__STORY__,locationsMap:__ADDS_MAP__}}).addDecorator(withSourceLoader(__STORY__,__ADDS_MAP__,"/Editor.stories.tsx",[],{},"/Users/fedorovskyi/my-git/draft-js-image-render-plugin/src/components/Editor",{})).add("Editor",(function(){return React.createElement(Editor_1.default,null)}))}).call(this,__webpack_require__(95)(module))},705:function(module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.imageRenderPlugin=void 0;var React=__importStar(__webpack_require__(1)),draft_js_plugins_editor_1=__importDefault(__webpack_require__(315)),draft_js_focus_plugin_1=__importDefault(__webpack_require__(812)),draft_js_plugins_editor_2=__webpack_require__(315),react_json_view_1=__importDefault(__webpack_require__(822)),draft_js_1=__webpack_require__(14),draft_js_export_html_1=__webpack_require__(830),draft_js_image_render_plugin_1=__importStar(__webpack_require__(355)),Image_1=__importDefault(__webpack_require__(825)),Editor_styled_1=__webpack_require__(829),focusPlugin=draft_js_focus_plugin_1.default();console.log(draft_js_plugins_editor_2.composeDecorators(focusPlugin.decorator)),exports.imageRenderPlugin=draft_js_image_render_plugin_1.default({imageComponent:Image_1.default,decorator:draft_js_plugins_editor_2.composeDecorators(focusPlugin.decorator)});var plugins=[focusPlugin,exports.imageRenderPlugin];exports.default=function(){var editorRef=React.useRef(null),_a=React.useState(draft_js_1.EditorState.createEmpty()),editorState=_a[0],setEditorState=_a[1],html=React.useMemo((function(){var currentContent=editorState.getCurrentContent();return draft_js_export_html_1.stateToHTML(currentContent)}),[editorState]);return React.createElement("div",null,React.createElement(Editor_styled_1.Wrapper,null,React.createElement(draft_js_plugins_editor_1.default,{ref:editorRef,plugins:plugins,editorState:editorState,onChange:function(state){setEditorState(state)}})),React.createElement("button",{onClick:function(){var newState=draft_js_image_render_plugin_1.addImage(editorState,"https://via.placeholder.com/350x150",{});setEditorState(newState)}},"ADD IMAGE"),React.createElement("p",null,"COUNT: ",function(editorState){return editorState.getCurrentContent().getPlainText("").trim().length}(editorState)),React.createElement("div",null,React.createElement("h3",null,"Result (HTML):"),React.createElement("div",{dangerouslySetInnerHTML:{__html:html}})),React.createElement(react_json_view_1.default,{src:draft_js_1.convertToRaw(editorState.getCurrentContent()),collapsed:3}))}},823:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var draft_js_1=__webpack_require__(14);exports.default=function(editorState,url,extraData){var entityKey=editorState.getCurrentContent().createEntity("IMAGE","IMMUTABLE",__assign(__assign({},extraData),{src:url})).getLastCreatedEntityKey(),newEditorState=draft_js_1.AtomicBlockUtils.insertAtomicBlock(editorState,entityKey,"i");return draft_js_1.EditorState.forceSelection(newEditorState,newEditorState.getCurrentContent().getSelectionAfter())}},824:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var draft_js_1=__webpack_require__(14);exports.default=function(contentState,blockKey){var targetRange,afterKey=contentState.getKeyAfter(blockKey),afterBlock=contentState.getBlockForKey(afterKey);targetRange=afterBlock&&"unstyled"===afterBlock.getType()&&0===afterBlock.getLength()&&afterBlock===contentState.getBlockMap().last()?new draft_js_1.SelectionState({anchorKey:blockKey,anchorOffset:0,focusKey:afterKey,focusOffset:0}):new draft_js_1.SelectionState({anchorKey:blockKey,anchorOffset:0,focusKey:blockKey,focusOffset:1});var newContentState=draft_js_1.Modifier.setBlockType(contentState,targetRange,"unstyled");return draft_js_1.Modifier.removeRange(newContentState,targetRange,"backward")}},825:function(module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});var Image_1=__importDefault(__webpack_require__(826));exports.default=Image_1.default},826:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0});var React=__importStar(__webpack_require__(1)),draft_js_1=__webpack_require__(14),draft_js_image_render_plugin_1=__webpack_require__(355),Styled=__importStar(__webpack_require__(827));exports.default=function(_a){var block=_a.block,contentState=_a.contentState,props=__rest(_a,["block","contentState"]),_b=contentState.getEntity(block.getEntityAt(0)).getData(),src=_b.src,height=_b.height,width=_b.width,alt=_b.alt;React.useEffect((function(){console.log("image",props)}),[]);return React.createElement(Styled.ImageWrapper,null,React.createElement("button",{onClick:function(){var editorState=props.getEditorState(),setEditorState=props.setEditorState,selectionState=editorState.getSelection(),newContentState=draft_js_image_render_plugin_1.removeBlock(contentState,selectionState.getFocusKey());setEditorState(draft_js_1.EditorState.push(editorState,newContentState,"delete-character"))}},"DELETE IMAGE"),React.createElement(Styled.Image,__assign({src:src,alt:alt,height:height,width:width},props,{role:"presentation"})))}},827:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Image=exports.ImageWrapper=void 0;var templateObject_1,templateObject_2,styled_components_1=__importDefault(__webpack_require__(356));exports.ImageWrapper=styled_components_1.default.figure(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  position: relative;\n"],["\n  position: relative;\n"]))),exports.Image=styled_components_1.default.img(templateObject_2||(templateObject_2=__makeTemplateObject(["\n  max-width: 100%;\n  transition: box-shadow 0.2s;\n  object-fit: cover;\n\n  &.draftJsFocusPlugin__unfocused__1Wvrs:hover {\n    border-radius: 4px;\n    box-shadow: 0 0 0 2px #aeb2c9;\n  }\n\n  &.draftJsFocusPlugin__focused__3Mksn {\n    border-radius: 4px;\n    box-shadow: 0 0 0 2px #00badd;\n  }\n"],["\n  max-width: 100%;\n  transition: box-shadow 0.2s;\n  object-fit: cover;\n\n  &.draftJsFocusPlugin__unfocused__1Wvrs:hover {\n    border-radius: 4px;\n    box-shadow: 0 0 0 2px #aeb2c9;\n  }\n\n  &.draftJsFocusPlugin__focused__3Mksn {\n    border-radius: 4px;\n    box-shadow: 0 0 0 2px #00badd;\n  }\n"])))},829:function(module,exports,__webpack_require__){"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Wrapper=void 0;var templateObject_1,styled_components_1=__importDefault(__webpack_require__(356));exports.Wrapper=styled_components_1.default.div(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  box-sizing: border-box;\n  border: 1px solid #ddd;\n  cursor: text;\n  padding: 16px;\n  border-radius: 2px;\n  margin-bottom: 2em;\n  box-shadow: inset 0 1px 8px -3px #ababab;\n  background: #fefefe;\n"],["\n  box-sizing: border-box;\n  border: 1px solid #ddd;\n  cursor: text;\n  padding: 16px;\n  border-radius: 2px;\n  margin-bottom: 2em;\n  box-shadow: inset 0 1px 8px -3px #ababab;\n  background: #fefefe;\n"])))}},[[360,1,2]]]);
//# sourceMappingURL=main.623902f36afbd6a87ea5.bundle.js.map